{"ast":null,"code":"import _classCallCheck from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/src/components/map/pizzaPlaces.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport PizzaPlace from './pizzaPlace';\n\nvar PizzaPlaces =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PizzaPlaces, _Component);\n\n  function PizzaPlaces() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PizzaPlaces);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PizzaPlaces)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      pizza_place_list: [],\n      lat: '',\n      lng: '',\n      selectPlace: [],\n      randomPlace: [],\n      redirect: false\n    };\n\n    _this.componentWillReceiveProps = function () {\n      var lat = _this.props.lat;\n      var lng = _this.props.lng;\n\n      _this.setState({\n        lat: lat,\n        lng: lng\n      });\n\n      console.log(\"Pizza Places: \", \"Lat: \".concat(lat, \" Lng: \").concat(lng));\n    };\n\n    _this.handleSelectPlace = function (e) {\n      var pizzaShop = e.target.id;\n      var selection = _this.state.pizza_place_list;\n      var randomselect = _this.props.randomPlace;\n      var selectedPlace = selection.find(function (s) {\n        return s.id === pizzaShop;\n      });\n      selectedPlace === [] ? _this.props.selectedPlace(randomselect) : _this.props.selectedPlace(selectedPlace);\n      console.log(\"Sel \" + selectedPlace + \" Rand \" + randomselect);\n\n      _this.setState({\n        redirect: true\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(PizzaPlaces, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      /*so we don't update on every little change, just check to see\n      if lat or lon changed */\n      if (this.props.lat !== prevProps.lat || this.props.lng !== prevProps.lng) {\n        console.log(\"Pizza Places: \", \"Previous Lat: \".concat(prevProps.lat, \" and Prevous Lon:\").concat(prevProps.lng));\n        console.log(\"Pizza Places: \", \"Current Lat: \".concat(this.props.lat, \" and Current Lon:\").concat(this.props.lng)); //make rest call\n\n        this.getPizzaPlacesFromHereAPI();\n      }\n    }\n  }, {\n    key: \"getPizzaPlacesFromHereAPI\",\n    value: function getPizzaPlacesFromHereAPI() {\n      var _this2 = this;\n\n      var here_api_url = \"https://places.cit.api.here.com/places/v1/autosuggest?\";\n      var here_api_at = \"at=\".concat(this.props.lat, \",\").concat(this.props.lng, \"&\");\n      var here_api_q = \"q=pizza&\";\n      var here_api_app_id = \"app_id=\".concat(process.env.REACT_APP_HERE_API_APP_ID, \"&\");\n      var here_api_app_code = \"app_code=\".concat(process.env.REACT_APP_HERE_API_APP_CODE); //the built-in fetch API will make the REST/AJAX call for us: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch    \n\n      fetch(here_api_url + here_api_at + here_api_q + here_api_app_id + here_api_app_code).then(function (response) {\n        //call HERE API and get returned list\n        return response.json();\n      }) //filter down to response that have locations (lat/lon)\n      .then(function (responseAsJson) {\n        //use the JavaScript filter method - https://www.w3schools.com/jsref/jsref_filter.asp\n        var filtered = responseAsJson.results.filter(function (result) {\n          //this checks to see if this record has a position array\n          return result.position;\n        }); //return the filtered results\n\n        return filtered;\n      }) //receive the promise response returned as a JSON object\n      .then(function (filtered) {\n        _this2.setState(function () {\n          return {\n            pizza_place_list: filtered\n          };\n        });\n\n        return filtered;\n      }).then(function () {\n        var places = _this2.state.pizza_place_list; //get a random pizza place and set the parent state with it            \n\n        if (places.length > 0) {\n          var randomPlace = _this2.props.sendRandomPlace(places[Math.floor(Math.random() * places.length)]);\n\n          _this2.setState({\n            randomPlace: randomPlace\n          });\n        }\n\n        _this2.state.pizza_place_list.forEach(function (pizza_place) {// const pizzalocation = pizza_place.title + ' ' +\n          //     pizza_place.vicinity + ' ' +\n          //     pizza_place.category;\n        });\n      }).catch(function (error) {\n        return console.error(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var places = this.state.pizza_place_list;\n\n      if (this.state.redirect === true) {\n        return React.createElement(Redirect, {\n          to: \"/home\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        });\n      }\n\n      ;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"bg-secondary p-3 text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"Click the title of a nearby pizza shop below to deliver your pizza or\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }), \"Click \", React.createElement(\"button\", {\n        className: \"btn btn-sm btn-primary\",\n        onClick: this.handleSelectPlace,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, \"Here\"), \" and we'll randomly select one for you.\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, this.props.title), React.createElement(\"div\", {\n        className: \"card-columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, places.map(function (place) {\n        return React.createElement(PizzaPlace, {\n          key: place.id,\n          placedata: place,\n          selectPlace: _this3.handleSelectPlace,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        });\n      }))));\n    }\n  }]);\n\n  return PizzaPlaces;\n}(Component);\n\nexport default PizzaPlaces;","map":{"version":3,"sources":["/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/src/components/map/pizzaPlaces.js"],"names":["React","Component","Redirect","PizzaPlace","PizzaPlaces","state","pizza_place_list","lat","lng","selectPlace","randomPlace","redirect","componentWillReceiveProps","props","setState","console","log","handleSelectPlace","e","pizzaShop","target","id","selection","randomselect","selectedPlace","find","s","prevProps","prevState","snapshot","getPizzaPlacesFromHereAPI","here_api_url","here_api_at","here_api_q","here_api_app_id","process","env","REACT_APP_HERE_API_APP_ID","here_api_app_code","REACT_APP_HERE_API_APP_CODE","fetch","then","response","json","responseAsJson","filtered","results","filter","result","position","places","length","sendRandomPlace","Math","floor","random","forEach","pizza_place","catch","error","title","map","place"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nimport PizzaPlace from './pizzaPlace'\n\nclass PizzaPlaces extends Component {\n    state = {\n        pizza_place_list: [],\n        lat: '',\n        lng: '',\n        selectPlace: [],\n        randomPlace: [],\n        redirect: false\n    }\n\n    componentWillReceiveProps = () => {\n        let lat = this.props.lat;\n        let lng = this.props.lng;\n        this.setState({\n            lat,\n            lng\n        });\n        console.log(\"Pizza Places: \", `Lat: ${lat} Lng: ${lng}`);\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n\n        /*so we don't update on every little change, just check to see\n        if lat or lon changed */\n        if (this.props.lat !== prevProps.lat || this.props.lng !== prevProps.lng) {\n\n            console.log(\"Pizza Places: \", `Previous Lat: ${prevProps.lat} and Prevous Lon:${prevProps.lng}`);\n            console.log(\"Pizza Places: \", `Current Lat: ${this.props.lat} and Current Lon:${this.props.lng}`);\n\n            //make rest call\n            this.getPizzaPlacesFromHereAPI();\n        }\n\n    }\n\n    getPizzaPlacesFromHereAPI() {\n\n        const here_api_url = \"https://places.cit.api.here.com/places/v1/autosuggest?\";\n        const here_api_at = `at=${this.props.lat},${this.props.lng}&`;\n        const here_api_q = \"q=pizza&\";\n        const here_api_app_id = `app_id=${process.env.REACT_APP_HERE_API_APP_ID}&`;\n        const here_api_app_code = `app_code=${process.env.REACT_APP_HERE_API_APP_CODE}`;\n\n        //the built-in fetch API will make the REST/AJAX call for us: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch    \n        fetch(here_api_url + here_api_at + here_api_q + here_api_app_id + here_api_app_code)\n            .then((response) => {\n                //call HERE API and get returned list\n                return response.json();\n            }\n            )\n            //filter down to response that have locations (lat/lon)\n            .then((responseAsJson) => {\n\n                //use the JavaScript filter method - https://www.w3schools.com/jsref/jsref_filter.asp\n                const filtered = responseAsJson.results.filter((result) => {\n                    //this checks to see if this record has a position array\n                    return result.position;\n\n                });\n\n                //return the filtered results\n                return filtered;\n\n            })\n            //receive the promise response returned as a JSON object\n            .then((filtered) => {\n\n                this.setState(() => {\n                    return {\n                        pizza_place_list: filtered,\n                    }\n                }\n                );\n\n                return filtered;\n            })\n            .then(() => {\n\n                const places = this.state.pizza_place_list;\n\n                //get a random pizza place and set the parent state with it            \n                if (places.length > 0) {\n                    const randomPlace = this.props.sendRandomPlace(places[Math.floor(Math.random() * places.length)]);\n\n                    this.setState({\n                        randomPlace\n                    });\n                }\n\n                this.state.pizza_place_list.forEach((pizza_place) => {\n                    // const pizzalocation = pizza_place.title + ' ' +\n                    //     pizza_place.vicinity + ' ' +\n                    //     pizza_place.category;\n\n                }\n                );\n            })\n            .catch(error => console.error(error));\n    }\n\n    handleSelectPlace = (e) => {\n        const pizzaShop = e.target.id;\n        const selection = this.state.pizza_place_list;\n        const randomselect = this.props.randomPlace;\n\n        const selectedPlace = selection.find(s => s.id === pizzaShop);\n\n        (selectedPlace === []) ? this.props.selectedPlace(randomselect) : this.props.selectedPlace(selectedPlace);\n\n        console.log(\"Sel \" + selectedPlace + \" Rand \" + randomselect);\n        this.setState({\n            redirect: true\n        });\n    }\n\n    render() {\n        const places = this.state.pizza_place_list;\n        if (this.state.redirect === true) { return <Redirect to='/home' /> };\n        return (\n            <React.Fragment>\n                <h5 className=\"bg-secondary p-3 text-white\">Click the title of a nearby pizza shop below to deliver your pizza or<br />\n                    Click <button className=\"btn btn-sm btn-primary\" onClick={this.handleSelectPlace}>Here</button> and we'll randomly select one for you.</h5>\n                <div>\n                    <h1>{this.props.title}</h1>\n                    <div className=\"card-columns\">\n                        {places.map((place) =>\n                            <PizzaPlace key={place.id}\n                                placedata={place}\n                                selectPlace={this.handleSelectPlace} />\n                        )}\n                    </div>\n                </div>\n            </React.Fragment >\n        );\n    }\n}\n\nexport default PizzaPlaces;"]},"metadata":{},"sourceType":"module"}