{"ast":null,"code":"import _classCallCheck from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/src/components/map/pizzaPlaces.js\";\nimport React, { Component } from 'react';\nimport PizzaPlace from './pizzaPlace';\nvar component_name = \"Pizza Places: \";\n\nvar PizzaPlaces =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PizzaPlaces, _Component);\n\n  function PizzaPlaces() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PizzaPlaces);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PizzaPlaces)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      pizza_place_list: [],\n      lat: '',\n      lng: '',\n      selectPlace: [],\n      randomPlace: []\n    };\n\n    _this.componentDidMount = function () {\n      var lat = _this.props.lat;\n      var lng = _this.props.lng;\n\n      _this.setState({\n        lat: lat,\n        lng: lng\n      });\n\n      console.log(component_name, \"Lat: \".concat(lat, \" Lng: \").concat(lng));\n    };\n\n    _this.handleSelectPlace = function (e) {\n      var pizzaShop = e.target.id;\n      var selection = _this.state.pizza_place_list;\n      console.log(selection.find(function (s) {\n        return s.id === pizzaShop;\n      })); // TODO: redirect to selection page with accessible selection.\n      //       if no selection is made, select the random generated one\n    };\n\n    return _this;\n  }\n\n  _createClass(PizzaPlaces, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      /*so we don't update on every little change, just check to see\n      if lat or lon changed */\n      if (this.props.lat !== prevProps.lat || this.props.lng !== prevProps.lng) {\n        console.log(component_name, \"Previous Lat: \".concat(prevProps.lat, \" and Prevous Lon:\").concat(prevProps.lng));\n        console.log(component_name, \"Current Lat: \".concat(this.props.lat, \" and Current Lon:\").concat(this.props.lng)); //make rest call\n\n        this.getPizzaPlacesFromHereAPI();\n      }\n    }\n  }, {\n    key: \"getPizzaPlacesFromHereAPI\",\n    value: function getPizzaPlacesFromHereAPI() {\n      var _this2 = this;\n\n      var here_api_url = \"https://places.cit.api.here.com/places/v1/autosuggest?\";\n      var here_api_at = \"at=\".concat(this.props.lat, \",\").concat(this.props.lng, \"&\");\n      var here_api_q = \"q=pizza&\";\n      var here_api_app_id = \"app_id=\".concat(process.env.REACT_APP_HERE_API_APP_ID, \"&\");\n      var here_api_app_code = \"app_code=\".concat(process.env.REACT_APP_HERE_API_APP_CODE); //the built-in fetch API will make the REST/AJAX call for us: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch    \n\n      fetch(here_api_url + here_api_at + here_api_q + here_api_app_id + here_api_app_code).then(function (response) {\n        //call HERE API and get returned list\n        return response.json();\n      }) //filter down to response that have locations (lat/lon)\n      .then(function (responseAsJson) {\n        //use the JavaScript filter method - https://www.w3schools.com/jsref/jsref_filter.asp\n        var filtered = responseAsJson.results.filter(function (result) {\n          //this checks to see if this record has a position array\n          return result.position;\n        }); //return the filtered results\n\n        return filtered;\n      }) //receive the promise response returned as a JSON object\n      .then(function (filtered) {\n        _this2.setState(function () {\n          return {\n            pizza_place_list: filtered\n          };\n        });\n\n        return filtered;\n      }).then(function () {\n        var places = _this2.state.pizza_place_list; //get a random pizza place and set the parent state with it            \n\n        if (places.length > 0) {\n          var randomPlace = _this2.props.sendRandomPlace(places[Math.floor(Math.random() * places.length)]);\n\n          _this2.setState({\n            randomPlace: randomPlace\n          });\n        } // this.state.pizza_place_list.forEach((pizza_place) => {\n        //     // const pizzalocation = pizza_place.title + ' ' +\n        //     //     pizza_place.vicinity + ' ' +\n        //     //     pizza_place.category;\n        // }\n        // );\n\n      }).catch(function (error) {\n        return console.error(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var places = this.state.pizza_place_list;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"bg-secondary p-3 text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Click the title of a nearby pizza shop below to deliver you pizza or we select one randomly for you.\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, this.props.title), React.createElement(\"div\", {\n        className: \"card-columns\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, places.map(function (place) {\n        return React.createElement(PizzaPlace, {\n          key: place.id,\n          placedata: place,\n          selectPlace: _this3.handleSelectPlace,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        });\n      }))));\n    }\n  }]);\n\n  return PizzaPlaces;\n}(Component);\n\nexport default PizzaPlaces;","map":{"version":3,"sources":["/Users/johncunningham/Desktop/Spring 2019/CIDM4385-Mobile-App-Dev/CIDM4385/assignment3/pizza-bandit/src/components/map/pizzaPlaces.js"],"names":["React","Component","PizzaPlace","component_name","PizzaPlaces","state","pizza_place_list","lat","lng","selectPlace","randomPlace","componentDidMount","props","setState","console","log","handleSelectPlace","e","pizzaShop","target","id","selection","find","s","prevProps","prevState","snapshot","getPizzaPlacesFromHereAPI","here_api_url","here_api_at","here_api_q","here_api_app_id","process","env","REACT_APP_HERE_API_APP_ID","here_api_app_code","REACT_APP_HERE_API_APP_CODE","fetch","then","response","json","responseAsJson","filtered","results","filter","result","position","places","length","sendRandomPlace","Math","floor","random","catch","error","title","map","place"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport PizzaPlace from './pizzaPlace';\n\nlet component_name = \"Pizza Places: \"\n\nclass PizzaPlaces extends Component {\n    state = {\n        pizza_place_list: [],\n        lat: '',\n        lng: '',\n        selectPlace: [],\n        randomPlace: []\n    }\n\n    componentDidMount = () => {\n        let lat = this.props.lat;\n        let lng = this.props.lng;\n        this.setState({\n            lat,\n            lng\n        });\n        console.log(component_name, `Lat: ${lat} Lng: ${lng}`);\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n\n        /*so we don't update on every little change, just check to see\n        if lat or lon changed */\n        if (this.props.lat !== prevProps.lat || this.props.lng !== prevProps.lng) {\n\n            console.log(component_name, `Previous Lat: ${prevProps.lat} and Prevous Lon:${prevProps.lng}`);\n            console.log(component_name, `Current Lat: ${this.props.lat} and Current Lon:${this.props.lng}`);\n\n            //make rest call\n            this.getPizzaPlacesFromHereAPI();\n        }\n\n    }\n\n    getPizzaPlacesFromHereAPI() {\n\n        const here_api_url = \"https://places.cit.api.here.com/places/v1/autosuggest?\";\n        const here_api_at = `at=${this.props.lat},${this.props.lng}&`;\n        const here_api_q = \"q=pizza&\";\n        const here_api_app_id = `app_id=${process.env.REACT_APP_HERE_API_APP_ID}&`;\n        const here_api_app_code = `app_code=${process.env.REACT_APP_HERE_API_APP_CODE}`;\n\n        //the built-in fetch API will make the REST/AJAX call for us: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch    \n        fetch(here_api_url + here_api_at + here_api_q + here_api_app_id + here_api_app_code)\n            .then((response) => {\n                //call HERE API and get returned list\n                return response.json();\n            }\n            )\n            //filter down to response that have locations (lat/lon)\n            .then((responseAsJson) => {\n\n                //use the JavaScript filter method - https://www.w3schools.com/jsref/jsref_filter.asp\n                const filtered = responseAsJson.results.filter((result) => {\n                    //this checks to see if this record has a position array\n                    return result.position;\n\n                });\n\n                //return the filtered results\n                return filtered;\n\n            })\n            //receive the promise response returned as a JSON object\n            .then((filtered) => {\n\n                this.setState(() => {\n                    return {\n                        pizza_place_list: filtered,\n                    }\n                }\n                );\n\n                return filtered;\n            })\n            .then(() => {\n\n                const places = this.state.pizza_place_list;\n\n                //get a random pizza place and set the parent state with it            \n                if (places.length > 0) {\n                    const randomPlace = this.props.sendRandomPlace(places[Math.floor(Math.random() * places.length)]);\n\n                    this.setState({\n                        randomPlace: randomPlace\n                    });\n                }\n\n                // this.state.pizza_place_list.forEach((pizza_place) => {\n                //     // const pizzalocation = pizza_place.title + ' ' +\n                //     //     pizza_place.vicinity + ' ' +\n                //     //     pizza_place.category;\n\n                // }\n                // );\n            })\n            .catch(error => console.error(error));\n    }\n\n    handleSelectPlace = (e) => {\n        const pizzaShop = e.target.id;\n        const selection = this.state.pizza_place_list;\n\n        console.log(selection.find(s => s.id === pizzaShop));\n\n        // TODO: redirect to selection page with accessible selection.\n        //       if no selection is made, select the random generated one\n\n    }\n\n    render() {\n\n        const places = this.state.pizza_place_list;\n        return (\n            <React.Fragment>\n                <div className=\"bg-secondary p-3 text-white\">Click the title of a nearby pizza shop below to deliver you pizza or we select one randomly for you.</div>\n                <div>\n                    <h1>{this.props.title}</h1>\n                    <div className=\"card-columns\">\n                        {places.map((place) =>\n                            <PizzaPlace key={place.id}\n                                placedata={place}\n                                selectPlace={this.handleSelectPlace} />\n                        )}\n                    </div>\n                </div>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default PizzaPlaces;"]},"metadata":{},"sourceType":"module"}